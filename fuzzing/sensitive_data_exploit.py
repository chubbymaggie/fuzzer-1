class SensitiveDataExploit():
	"""
	implements the concrete sensitive data exploit
	strategy
	"""

	def execute(self, pages, session, strategy):
		"""
		execute strategy - fuzz all inputs and make sure 
		they have been sanitized
		"""
		vectors = strategy._getVectors()

		for page in pages:
			forms = page.get("inputs").get("forms")
			url = page.get("url")
			
			for form in forms:
				for vector in vectors:
					response = strategy._executeVector(url, vector, form)

					if response != None:
						sanitized =self._checkForSensitiveData(vector,response)
						if not sanitized :
							logger.info("Sensitive data leaked - \n  Page: %s\n  Form: %s\n  Vector: %s\n  Status:Code: %s\n" 
										% (url,form,vector,response.status_code) )

	def _checkForSensitiveData(self, vector, response):
		
		""" 
		check that response has been sanitized. 
		@vector - vector executed
		@response - the response given
		"""

      	sensitive = open(self.options.sensitive, "r").read().splitlines()

      	for item in sensitive
      		if item in response.text:
      			return false

		return true;