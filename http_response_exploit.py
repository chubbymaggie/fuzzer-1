class HttpResponseExploit():
	"""
	implements the http response code exploit
	strategy

	If the HTTP response code is not OK (i.e. 200),
	then something went wrong. Report it.
	"""

	def execute(self, pages, session, strategy):
		"""
		execute strategy
		"""
		
		vectors = strategy._getVectors()

		logger.info("Sending requests to vectors and checking for request failures...")

		for page in pages:
			forms = page.get("inputs").get("forms")
			url = page.get("url")

			for form in forms:
				for vector in vectors:

					response = strategy._executeVector(url, vector, form)

					if response.status_code != 200 :
						logger.info("Request not successful-\n  Page: %s\n  Form: %s\n  Vector: %s\n  Status Code: %s\n" 
										% (url,form,vector,response.status_code) )